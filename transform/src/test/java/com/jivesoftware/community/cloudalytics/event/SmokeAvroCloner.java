package com.jivesoftware.community.cloudalytics.event;

import com.fasterxml.jackson.databind.ObjectMapper;
import com.jivesoftware.community.cloudalytics.event.avro.AvroEvent;
import com.jivesoftware.community.cloudalytics.event.jsonschema.EventDocument;
import org.apache.avro.file.DataFileWriter;
import org.apache.avro.io.DatumWriter;
import org.apache.avro.specific.SpecificDatumWriter;
import org.apache.avro.specific.SpecificRecord;
import org.junit.Test;

import java.io.File;
import java.io.IOException;

/**
 * Created by gary.schulte on 4/18/16.
 */
public class SmokeAvroCloner {
    ObjectMapper mapper = new ObjectMapper();
    String TMP_OUT = "/tmp/AvroOutput.avro";
    String megaNestedComment = "{\"name\":\"ACTIVITY_MENTION_USER\",\"timestamp\":1461005279246,\"seqId\":277210,\"uuid\":\"125962e0-0596-11e6-b191-005056b908c2\",\"context\":{\"jvm\":{\"jvmHome\":\"/usr/local/jive/applications/brewspace/.\",\"jvmIpAddr\":\"nic=eth1,mac=00:00:06:f9:08:f2,ip=10.10.60.74;nic=eth0,mac=00:00:06:f9:08:f1,ip=10.10.80.74\",\"jvmHost\":\"brew-wa02\",\"jvmUid\":\"15fa5800-005f-11e6-b191-005056b908c2\"},\"web\":{\"anon\":\"false\",\"visible\":\"true\",\"userAgent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/601.5.17 (KHTML, like Gecko) Version/9.1 Safari/601.5.17\",\"sessionId\":\"0E22A6ACA7C931D0CD3A718998721728.node02\",\"userId\":\"8827\",\"external\":\"false\",\"federated\":\"true\",\"partner\":\"false\",\"valueCase\":\"ob\",\"requestId\":\"12536f70-0596-11e6-b191-005056b908c2\",\"appID\":\"web\",\"userEmail\":\"judith.rich@jivesoftware.com\",\"userType\":\"REGULAR\",\"flowId\":\"12536f71-0596-11e6-b191-005056b908c2\",\"username\":\"Judith.Rich\"},\"service\":{\"serviceVersion\":\"2016.2.0.0\",\"instanceId\":\"99927a59-3eff-4000-b243-b5d16ed97999\",\"instanceType\":\"\",\"tenantId\":\"99927a59-3eff-4000-b243-b5d16ed97999\",\"serviceName\":\"Jive SBS\",\"jiveUrl\":\"https://brewspace.jiveland.com\"}},\"payload\":{},\"actorID\":8827,\"actorType\":3,\"activityType\":\"Mention\",\"actionObjectId\":2048122,\"actionObjectType\":105,\"containerId\":5490,\"containerType\":700,\"activity\":{\"actor\":{\"@class\":\".Actor\",\"objectType\":\"user\",\"objectId\":8827,\"objectHash\":\"14b82686aaa53c9a0d8fa03012a6e429e67e6185\",\"isDataAvailable\":true,\"extras\":{},\"tags\":[],\"username\":\"Judith.Rich\",\"name\":\"Judith Rich\",\"firstName\":\"Judith\",\"lastName\":\"Rich\",\"email\":\"judith.rich@jivesoftware.com\",\"creationDate\":1428649212056,\"modificationDate\":1460962818371,\"profile\":{\"hasAvatar\":\"true\",\"hasProfileImage\":\"true\",\"phoneNumber\":\"+1 (503) 575-4412\",\"company\":\"Jive Software\",\"office\":\"Portland\",\"title\":\"Senior Branded Content Manager\",\"department\":\"Marketing\"},\"enabled\":true,\"lastLoggedIn\":1460741627513,\"lastProfileUpdate\":1460962818371,\"type\":\"REGULAR\",\"federated\":true,\"visible\":true,\"status\":\"registered\",\"url\":\"https://brewspace.jiveland.com/people/Judith.Rich\"},\"action\":\"Mention\",\"actionObject\":{\"@class\":\".CommentContent\",\"objectType\":\"comment\",\"objectId\":2048122,\"objectHash\":\"8b5fe0ec027824e11a7211a43069e844b6183ca2\",\"isDataAvailable\":true,\"extras\":{\"mentionId\":8775,\"mentionName\":\"Jason Harris\",\"mentionType\":3,\"recipientUser\":{\"objectType\":\"user\",\"objectId\":8775,\"isDataAvailable\":true,\"extras\":{},\"tags\":[],\"username\":\"jason.harris\",\"name\":\"Jason Harris\",\"firstName\":\"Jason\",\"lastName\":\"Harris\",\"email\":\"jason.harris@jivesoftware.com\",\"creationDate\":1427439612827,\"modificationDate\":1460409131229,\"profile\":{\"hasAvatar\":\"true\",\"hasProfileImage\":\"true\",\"phoneNumber\":\"+1 (503) 467-2000\",\"company\":\"Vitamin T\",\"office\":\"Portland\",\"availability\":\"In Office\",\"title\":\"Art Director\",\"department\":\"Marketing\",\"jive-wLocation\":\"PDX [America/Los_Angeles]\"},\"enabled\":true,\"lastLoggedIn\":1460409131140,\"lastProfileUpdate\":1460409131229,\"type\":\"REGULAR\",\"federated\":true,\"visible\":true,\"status\":\"registered\",\"url\":\"https://brewspace.jiveland.com/people/jason.harris\"},\"mentionUrl\":\"https://brewspace.jiveland.com/people/jason.harris\"},\"tags\":[],\"subject\":\"Creative Brief: (Creative + Content) [Effective Clinical Communication] \",\"creationDate\":1461005279214,\"modifiedDate\":1461005279214,\"author\":{\"@class\":\".Actor\",\"objectType\":\"user\",\"objectId\":8827,\"isDataAvailable\":false,\"extras\":{},\"tags\":[],\"username\":\"Judith.Rich\",\"name\":\"Judith Rich\",\"firstName\":\"Judith\",\"lastName\":\"Rich\",\"email\":\"judith.rich@jivesoftware.com\",\"creationDate\":1428649212056,\"modificationDate\":1460962818371,\"profile\":{\"hasAvatar\":\"true\",\"hasProfileImage\":\"true\",\"phoneNumber\":\"+1 (503) 575-4412\",\"company\":\"Jive Software\",\"office\":\"Portland\",\"title\":\"Senior Branded Content Manager\",\"department\":\"Marketing\"},\"enabled\":true,\"lastLoggedIn\":1460741627513,\"lastProfileUpdate\":1460962818371,\"type\":\"REGULAR\",\"federated\":true,\"visible\":true,\"status\":\"registered\",\"url\":\"https://brewspace.jiveland.com/people/Judith.Rich\"},\"containerId\":5490,\"containerType\":\"socialgroup\",\"isVisibleToPartner\":false,\"status\":\"PUBLISHED\",\"url\":\"https://brewspace.jiveland.com/docs/DOC-272185#comment-2048122\",\"fullPath\":\"/systemcontainer_17/socialgroup_5490\",\"normalizedPath\":\"/socialgroup_5490\",\"parentCommentId\":2048111,\"parentComment\":{\"@class\":\".CommentContent\",\"objectType\":\"comment\",\"objectId\":2048111,\"objectHash\":\"d05611748cc19786ab70d0139044b8595d98fbbd\",\"isDataAvailable\":true,\"extras\":{\"mentionId\":8775,\"mentionName\":\"Jason Harris\",\"mentionType\":3,\"recipientUser\":{\"objectType\":\"user\",\"objectId\":8775,\"isDataAvailable\":true,\"extras\":{},\"tags\":[],\"username\":\"jason.harris\",\"name\":\"Jason Harris\",\"firstName\":\"Jason\",\"lastName\":\"Harris\",\"email\":\"jason.harris@jivesoftware.com\",\"creationDate\":1427439612827,\"modificationDate\":1460409131229,\"profile\":{\"hasAvatar\":\"true\",\"hasProfileImage\":\"true\",\"phoneNumber\":\"+1 (503) 467-2000\",\"company\":\"Vitamin T\",\"office\":\"Portland\",\"availability\":\"In Office\",\"title\":\"Art Director\",\"department\":\"Marketing\",\"jive-wLocation\":\"PDX [America/Los_Angeles]\"},\"enabled\":true,\"lastLoggedIn\":1460409131140,\"lastProfileUpdate\":1460409131229,\"type\":\"REGULAR\",\"federated\":true,\"visible\":true,\"status\":\"registered\",\"url\":\"https://brewspace.jiveland.com/people/jason.harris\"},\"mentionUrl\":\"https://brewspace.jiveland.com/people/jason.harris\"},\"tags\":[],\"subject\":\"Creative Brief: (Creative + Content) [Effective Clinical Communication] \",\"creationDate\":1461005069150,\"modifiedDate\":1461005069150,\"author\":{\"@class\":\".Actor\",\"objectType\":\"user\",\"objectId\":9729,\"isDataAvailable\":false,\"extras\":{},\"tags\":[],\"username\":\"ian.botbyl\",\"name\":\"Ian Botbyl\",\"firstName\":\"Ian\",\"lastName\":\"Botbyl\",\"email\":\"ian.botbyl@jivesoftware.com\",\"creationDate\":1453945725292,\"modificationDate\":1460989281293,\"profile\":{\"mobilePhoneNumber\":\"+1 616-402-8514\",\"hasProfileImage\":\"true\",\"hireDate\":1454313600000,\"office\":\"Remote\",\"availability\":\"Working Remotely\",\"biography\":\"Helping Healthcare work better together! Coach, athlete, analyst, social collaborator, musician, geek, actor, director, fantasy football all-star, wrestling official, Grand Valley State University alumni, five star chef of breakfast foods. \",\"primaryWorkType\":\"Energizer\",\"linkedIn\":\"http://www.linkedin.com/in/ianbotbyl\",\"title\":\"Marketing Associate, Healthcare\",\"expertise\":\"Social business, social intranet, Healthcare IT, Information Technology, Jive 6 hosted, Jive 7 hosted, Jive Cloud, Jive 8 hosted, SharePoint, project management, training, coaching, film and video, presentations, Android, Confluence, audio, HTML, Adobe Creative Suite, CA Service Desk, SAP, SQL Server, JIRA, PING, HIPAA, Healthcare, Information Technology, Jive 6 hosted, Jive 7 hosted, Jive Cloud, Jive 8 hosted, SharePoint, project management, training, coaching, film and video, presentations, Android, Confluence, audio, HTML, Adobe Creative Suite, CA Service Desk, SAP, SQL Server, JIRA, PING SSO, HIPPA\",\"hasAvatar\":\"true\",\"previousCompanies\":\"Spectrum Health, Best Buy\",\"twitter\":\"Bots60\",\"workStyle\":\"Collaborative, coffee \",\"company\":\"Jive Software\",\"location\":\"Grand Rapids, MI\",\"department\":\"Product Marketing\",\"currentGoals\":\"Engage healthcare customers to use Jive more effectively \",\"jive-wLocation\":\"Remote\"},\"enabled\":true,\"lastLoggedIn\":1460989261197,\"lastProfileUpdate\":1460989261353,\"type\":\"REGULAR\",\"federated\":true,\"visible\":true,\"status\":\"registered\",\"url\":\"https://brewspace.jiveland.com/people/ian.botbyl\"},\"containerId\":5490,\"containerType\":\"socialgroup\",\"isVisibleToPartner\":false,\"status\":\"PUBLISHED\",\"url\":\"https://brewspace.jiveland.com/docs/DOC-272185#comment-2048111\",\"fullPath\":\"/systemcontainer_17/socialgroup_5490\",\"normalizedPath\":\"/socialgroup_5490\",\"parentCommentId\":2048095,\"parentComment\":{\"@class\":\".CommentContent\",\"objectType\":\"comment\",\"objectId\":2048095,\"objectHash\":\"3e6f5453c5b7a03cf3361d15303a3eaf4b242bb6\",\"isDataAvailable\":true,\"extras\":{\"mentionId\":8775,\"mentionName\":\"Jason Harris\",\"mentionType\":3,\"recipientUser\":{\"objectType\":\"user\",\"objectId\":8775,\"isDataAvailable\":true,\"extras\":{},\"tags\":[],\"username\":\"jason.harris\",\"name\":\"Jason Harris\",\"firstName\":\"Jason\",\"lastName\":\"Harris\",\"email\":\"jason.harris@jivesoftware.com\",\"creationDate\":1427439612827,\"modificationDate\":1460409131229,\"profile\":{\"hasAvatar\":\"true\",\"hasProfileImage\":\"true\",\"phoneNumber\":\"+1 (503) 467-2000\",\"company\":\"Vitamin T\",\"office\":\"Portland\",\"availability\":\"In Office\",\"title\":\"Art Director\",\"department\":\"Marketing\",\"jive-wLocation\":\"PDX [America/Los_Angeles]\"},\"enabled\":true,\"lastLoggedIn\":1460409131140,\"lastProfileUpdate\":1460409131229,\"type\":\"REGULAR\",\"federated\":true,\"visible\":true,\"status\":\"registered\",\"url\":\"https://brewspace.jiveland.com/people/jason.harris\"},\"mentionUrl\":\"https://brewspace.jiveland.com/people/jason.harris\"},\"tags\":[],\"subject\":\"Creative Brief: (Creative + Content) [Effective Clinical Communication] \",\"creationDate\":1461004275812,\"modifiedDate\":1461004275812,\"author\":{\"@class\":\".Actor\",\"objectType\":\"user\",\"objectId\":8827,\"isDataAvailable\":false,\"extras\":{},\"tags\":[],\"username\":\"Judith.Rich\",\"name\":\"Judith Rich\",\"firstName\":\"Judith\",\"lastName\":\"Rich\",\"email\":\"judith.rich@jivesoftware.com\",\"creationDate\":1428649212056,\"modificationDate\":1460962818371,\"profile\":{\"hasAvatar\":\"true\",\"hasProfileImage\":\"true\",\"phoneNumber\":\"+1 (503) 575-4412\",\"company\":\"Jive Software\",\"office\":\"Portland\",\"title\":\"Senior Branded Content Manager\",\"department\":\"Marketing\"},\"enabled\":true,\"lastLoggedIn\":1460741627513,\"lastProfileUpdate\":1460962818371,\"type\":\"REGULAR\",\"federated\":true,\"visible\":true,\"status\":\"registered\",\"url\":\"https://brewspace.jiveland.com/people/Judith.Rich\"},\"containerId\":5490,\"containerType\":\"socialgroup\",\"isVisibleToPartner\":false,\"status\":\"PUBLISHED\",\"url\":\"https://brewspace.jiveland.com/docs/DOC-272185#comment-2048095\",\"fullPath\":\"/systemcontainer_17/socialgroup_5490\",\"normalizedPath\":\"/socialgroup_5490\",\"parentCommentId\":2047003,\"parentComment\":{\"@class\":\".CommentContent\",\"objectType\":\"comment\",\"objectId\":2047003,\"objectHash\":\"c4d82f48ed1d2133f0eff617efda195ed13c70fe\",\"isDataAvailable\":true,\"extras\":{\"mentionId\":8775,\"mentionName\":\"Jason Harris\",\"mentionType\":3,\"recipientUser\":{\"objectType\":\"user\",\"objectId\":8775,\"isDataAvailable\":true,\"extras\":{},\"tags\":[],\"username\":\"jason.harris\",\"name\":\"Jason Harris\",\"firstName\":\"Jason\",\"lastName\":\"Harris\",\"email\":\"jason.harris@jivesoftware.com\",\"creationDate\":1427439612827,\"modificationDate\":1460409131229,\"profile\":{\"hasAvatar\":\"true\",\"hasProfileImage\":\"true\",\"phoneNumber\":\"+1 (503) 467-2000\",\"company\":\"Vitamin T\",\"office\":\"Portland\",\"availability\":\"In Office\",\"title\":\"Art Director\",\"department\":\"Marketing\",\"jive-wLocation\":\"PDX [America/Los_Angeles]\"},\"enabled\":true,\"lastLoggedIn\":1460409131140,\"lastProfileUpdate\":1460409131229,\"type\":\"REGULAR\",\"federated\":true,\"visible\":true,\"status\":\"registered\",\"url\":\"https://brewspace.jiveland.com/people/jason.harris\"},\"mentionUrl\":\"https://brewspace.jiveland.com/people/jason.harris\"},\"tags\":[],\"subject\":\"Creative Brief: (Creative + Content) [Effective Clinical Communication] \",\"creationDate\":1460750694404,\"modifiedDate\":1460750694404,\"author\":{\"@class\":\".Actor\",\"objectType\":\"user\",\"objectId\":9729,\"isDataAvailable\":false,\"extras\":{},\"tags\":[],\"username\":\"ian.botbyl\",\"name\":\"Ian Botbyl\",\"firstName\":\"Ian\",\"lastName\":\"Botbyl\",\"email\":\"ian.botbyl@jivesoftware.com\",\"creationDate\":1453945725292,\"modificationDate\":1460989281293,\"profile\":{\"mobilePhoneNumber\":\"+1 616-402-8514\",\"hasProfileImage\":\"true\",\"hireDate\":1454313600000,\"office\":\"Remote\",\"availability\":\"Working Remotely\",\"biography\":\"Helping Healthcare work better together! Coach, athlete, analyst, social collaborator, musician, geek, actor, director, fantasy football all-star, wrestling official, Grand Valley State University alumni, five star chef of breakfast foods. \",\"primaryWorkType\":\"Energizer\",\"linkedIn\":\"http://www.linkedin.com/in/ianbotbyl\",\"title\":\"Marketing Associate, Healthcare\",\"expertise\":\"Social business, social intranet, Healthcare IT, Information Technology, Jive 6 hosted, Jive 7 hosted, Jive Cloud, Jive 8 hosted, SharePoint, project management, training, coaching, film and video, presentations, Android, Confluence, audio, HTML, Adobe Creative Suite, CA Service Desk, SAP, SQL Server, JIRA, PING, HIPAA, Healthcare, Information Technology, Jive 6 hosted, Jive 7 hosted, Jive Cloud, Jive 8 hosted, SharePoint, project management, training, coaching, film and video, presentations, Android, Confluence, audio, HTML, Adobe Creative Suite, CA Service Desk, SAP, SQL Server, JIRA, PING SSO, HIPPA\",\"hasAvatar\":\"true\",\"previousCompanies\":\"Spectrum Health, Best Buy\",\"twitter\":\"Bots60\",\"workStyle\":\"Collaborative, coffee \",\"company\":\"Jive Software\",\"location\":\"Grand Rapids, MI\",\"department\":\"Product Marketing\",\"currentGoals\":\"Engage healthcare customers to use Jive more effectively \",\"jive-wLocation\":\"Remote\"},\"enabled\":true,\"lastLoggedIn\":1460989261197,\"lastProfileUpdate\":1460989261353,\"type\":\"REGULAR\",\"federated\":true,\"visible\":true,\"status\":\"registered\",\"url\":\"https://brewspace.jiveland.com/people/ian.botbyl\"},\"containerId\":5490,\"containerType\":\"socialgroup\",\"isVisibleToPartner\":false,\"status\":\"PUBLISHED\",\"url\":\"https://brewspace.jiveland.com/docs/DOC-272185#comment-2047003\",\"fullPath\":\"/systemcontainer_17/socialgroup_5490\",\"normalizedPath\":\"/socialgroup_5490\",\"parentCommentId\":2046976,\"parentComment\":{\"@class\":\".CommentContent\",\"objectType\":\"comment\",\"objectId\":2046976,\"objectHash\":\"ec3db4384653f23eb7acc0317088205cf11a63a2\",\"isDataAvailable\":true,\"extras\":{\"mentionId\":8775,\"mentionName\":\"Jason Harris\",\"mentionType\":3,\"recipientUser\":{\"objectType\":\"user\",\"objectId\":8775,\"isDataAvailable\":true,\"extras\":{},\"tags\":[],\"username\":\"jason.harris\",\"name\":\"Jason Harris\",\"firstName\":\"Jason\",\"lastName\":\"Harris\",\"email\":\"jason.harris@jivesoftware.com\",\"creationDate\":1427439612827,\"modificationDate\":1460409131229,\"profile\":{\"hasAvatar\":\"true\",\"hasProfileImage\":\"true\",\"phoneNumber\":\"+1 (503) 467-2000\",\"company\":\"Vitamin T\",\"office\":\"Portland\",\"availability\":\"In Office\",\"title\":\"Art Director\",\"department\":\"Marketing\",\"jive-wLocation\":\"PDX [America/Los_Angeles]\"},\"enabled\":true,\"lastLoggedIn\":1460409131140,\"lastProfileUpdate\":1460409131229,\"type\":\"REGULAR\",\"federated\":true,\"visible\":true,\"status\":\"registered\",\"url\":\"https://brewspace.jiveland.com/people/jason.harris\"},\"mentionUrl\":\"https://brewspace.jiveland.com/people/jason.harris\"},\"tags\":[],\"subject\":\"Creative Brief: (Creative + Content) [Effective Clinical Communication] \",\"creationDate\":1460750177637,\"modifiedDate\":1460750177637,\"author\":{\"@class\":\".Actor\",\"objectType\":\"user\",\"objectId\":8827,\"isDataAvailable\":false,\"extras\":{},\"tags\":[],\"username\":\"Judith.Rich\",\"name\":\"Judith Rich\",\"firstName\":\"Judith\",\"lastName\":\"Rich\",\"email\":\"judith.rich@jivesoftware.com\",\"creationDate\":1428649212056,\"modificationDate\":1460962818371,\"profile\":{\"hasAvatar\":\"true\",\"hasProfileImage\":\"true\",\"phoneNumber\":\"+1 (503) 575-4412\",\"company\":\"Jive Software\",\"office\":\"Portland\",\"title\":\"Senior Branded Content Manager\",\"department\":\"Marketing\"},\"enabled\":true,\"lastLoggedIn\":1460741627513,\"lastProfileUpdate\":1460962818371,\"type\":\"REGULAR\",\"federated\":true,\"visible\":true,\"status\":\"registered\",\"url\":\"https://brewspace.jiveland.com/people/Judith.Rich\"},\"containerId\":5490,\"containerType\":\"socialgroup\",\"isVisibleToPartner\":false,\"status\":\"PUBLISHED\",\"url\":\"https://brewspace.jiveland.com/docs/DOC-272185#comment-2046976\",\"fullPath\":\"/systemcontainer_17/socialgroup_5490\",\"normalizedPath\":\"/socialgroup_5490\",\"parentCommentId\":2046949,\"parentComment\":{\"@class\":\".CommentContent\",\"objectType\":\"comment\",\"objectId\":2046949,\"objectHash\":\"5d6c60f81282d1dbf1f071a4c31b790ede113f68\",\"isDataAvailable\":true,\"extras\":{\"mentionId\":8775,\"mentionName\":\"Jason Harris\",\"mentionType\":3,\"recipientUser\":{\"objectType\":\"user\",\"objectId\":8775,\"isDataAvailable\":true,\"extras\":{},\"tags\":[],\"username\":\"jason.harris\",\"name\":\"Jason Harris\",\"firstName\":\"Jason\",\"lastName\":\"Harris\",\"email\":\"jason.harris@jivesoftware.com\",\"creationDate\":1427439612827,\"modificationDate\":1460409131229,\"profile\":{\"hasAvatar\":\"true\",\"hasProfileImage\":\"true\",\"phoneNumber\":\"+1 (503) 467-2000\",\"company\":\"Vitamin T\",\"office\":\"Portland\",\"availability\":\"In Office\",\"title\":\"Art Director\",\"department\":\"Marketing\",\"jive-wLocation\":\"PDX [America/Los_Angeles]\"},\"enabled\":true,\"lastLoggedIn\":1460409131140,\"lastProfileUpdate\":1460409131229,\"type\":\"REGULAR\",\"federated\":true,\"visible\":true,\"status\":\"registered\",\"url\":\"https://brewspace.jiveland.com/people/jason.harris\"},\"mentionUrl\":\"https://brewspace.jiveland.com/people/jason.harris\"},\"tags\":[],\"subject\":\"Creative Brief: (Creative + Content) [Effective Clinical Communication] \",\"creationDate\":1460749598034,\"modifiedDate\":1460749598034,\"author\":{\"@class\":\".Actor\",\"objectType\":\"user\",\"objectId\":9729,\"isDataAvailable\":false,\"extras\":{},\"tags\":[],\"username\":\"ian.botbyl\",\"name\":\"Ian Botbyl\",\"firstName\":\"Ian\",\"lastName\":\"Botbyl\",\"email\":\"ian.botbyl@jivesoftware.com\",\"creationDate\":1453945725292,\"modificationDate\":1460989281293,\"profile\":{\"mobilePhoneNumber\":\"+1 616-402-8514\",\"hasProfileImage\":\"true\",\"hireDate\":1454313600000,\"office\":\"Remote\",\"availability\":\"Working Remotely\",\"biography\":\"Helping Healthcare work better together! Coach, athlete, analyst, social collaborator, musician, geek, actor, director, fantasy football all-star, wrestling official, Grand Valley State University alumni, five star chef of breakfast foods. \",\"primaryWorkType\":\"Energizer\",\"linkedIn\":\"http://www.linkedin.com/in/ianbotbyl\",\"title\":\"Marketing Associate, Healthcare\",\"expertise\":\"Social business, social intranet, Healthcare IT, Information Technology, Jive 6 hosted, Jive 7 hosted, Jive Cloud, Jive 8 hosted, SharePoint, project management, training, coaching, film and video, presentations, Android, Confluence, audio, HTML, Adobe Creative Suite, CA Service Desk, SAP, SQL Server, JIRA, PING, HIPAA, Healthcare, Information Technology, Jive 6 hosted, Jive 7 hosted, Jive Cloud, Jive 8 hosted, SharePoint, project management, training, coaching, film and video, presentations, Android, Confluence, audio, HTML, Adobe Creative Suite, CA Service Desk, SAP, SQL Server, JIRA, PING SSO, HIPPA\",\"hasAvatar\":\"true\",\"previousCompanies\":\"Spectrum Health, Best Buy\",\"twitter\":\"Bots60\",\"workStyle\":\"Collaborative, coffee \",\"company\":\"Jive Software\",\"location\":\"Grand Rapids, MI\",\"department\":\"Product Marketing\",\"currentGoals\":\"Engage healthcare customers to use Jive more effectively \",\"jive-wLocation\":\"Remote\"},\"enabled\":true,\"lastLoggedIn\":1460989261197,\"lastProfileUpdate\":1460989261353,\"type\":\"REGULAR\",\"federated\":true,\"visible\":true,\"status\":\"registered\",\"url\":\"https://brewspace.jiveland.com/people/ian.botbyl\"},\"containerId\":5490,\"containerType\":\"socialgroup\",\"isVisibleToPartner\":false,\"status\":\"PUBLISHED\",\"url\":\"https://brewspace.jiveland.com/docs/DOC-272185#comment-2046949\",\"fullPath\":\"/systemcontainer_17/socialgroup_5490\",\"normalizedPath\":\"/socialgroup_5490\",\"parentCommentId\":2046933,\"parentComment\":{\"@class\":\".CommentContent\",\"objectType\":\"comment\",\"objectId\":2046933,\"objectHash\":\"7b51a3988890373abf20214e8111705befbac92c\",\"isDataAvailable\":true,\"extras\":{\"mentionId\":8775,\"mentionName\":\"Jason Harris\",\"mentionType\":3,\"recipientUser\":{\"objectType\":\"user\",\"objectId\":8775,\"isDataAvailable\":true,\"extras\":{},\"tags\":[],\"username\":\"jason.harris\",\"name\":\"Jason Harris\",\"firstName\":\"Jason\",\"lastName\":\"Harris\",\"email\":\"jason.harris@jivesoftware.com\",\"creationDate\":1427439612827,\"modificationDate\":1460409131229,\"profile\":{\"hasAvatar\":\"true\",\"hasProfileImage\":\"true\",\"phoneNumber\":\"+1 (503) 467-2000\",\"company\":\"Vitamin T\",\"office\":\"Portland\",\"availability\":\"In Office\",\"title\":\"Art Director\",\"department\":\"Marketing\",\"jive-wLocation\":\"PDX [America/Los_Angeles]\"},\"enabled\":true,\"lastLoggedIn\":1460409131140,\"lastProfileUpdate\":1460409131229,\"type\":\"REGULAR\",\"federated\":true,\"visible\":true,\"status\":\"registered\",\"url\":\"https://brewspace.jiveland.com/people/jason.harris\"},\"mentionUrl\":\"https://brewspace.jiveland.com/people/jason.harris\"},\"tags\":[],\"subject\":\"Creative Brief: (Creative + Content) [Effective Clinical Communication] \",\"creationDate\":1460749056423,\"modifiedDate\":1460749056423,\"author\":{\"@class\":\".Actor\",\"objectType\":\"user\",\"objectId\":8827,\"isDataAvailable\":false,\"extras\":{},\"tags\":[],\"username\":\"Judith.Rich\",\"name\":\"Judith Rich\",\"firstName\":\"Judith\",\"lastName\":\"Rich\",\"email\":\"judith.rich@jivesoftware.com\",\"creationDate\":1428649212056,\"modificationDate\":1460962818371,\"profile\":{\"hasAvatar\":\"true\",\"hasProfileImage\":\"true\",\"phoneNumber\":\"+1 (503) 575-4412\",\"company\":\"Jive Software\",\"office\":\"Portland\",\"title\":\"Senior Branded Content Manager\",\"department\":\"Marketing\"},\"enabled\":true,\"lastLoggedIn\":1460741627513,\"lastProfileUpdate\":1460962818371,\"type\":\"REGULAR\",\"federated\":true,\"visible\":true,\"status\":\"registered\",\"url\":\"https://brewspace.jiveland.com/people/Judith.Rich\"},\"containerId\":5490,\"containerType\":\"socialgroup\",\"isVisibleToPartner\":false,\"status\":\"PUBLISHED\",\"url\":\"https://brewspace.jiveland.com/docs/DOC-272185#comment-2046933\",\"fullPath\":\"/systemcontainer_17/socialgroup_5490\",\"normalizedPath\":\"/socialgroup_5490\",\"parentCommentId\":-1}}}}}},\"combinedObjectTypeId\":\"105_2048122\"},\"activityTime\":1461005279246,\"destination\":{\"@class\":\".ActivityDestination\",\"objectType\":\"socialgroup\",\"objectId\":5490,\"objectHash\":\"e1c9c9e50f2ee2aaac0f8699ad62e05a14557233\",\"isDataAvailable\":true,\"extras\":{},\"tags\":[],\"name\":\"Creative Services Requests\",\"displayName\":\"creative-services-requests\",\"description\":\" \",\"creationDate\":1366741598897,\"modificationDate\":1460663194583,\"url\":\"https://brewspace.jiveland.com/groups/creative-services-requests\",\"status\":\"ACTIVE\",\"isVisibleToPartner\":false,\"parentId\":17,\"parentType\":\"systemcontainer\",\"fullPath\":\"/systemcontainer_17/socialgroup_5490\",\"normalizedPath\":\"/socialgroup_5490\",\"combinedObjectTypeId\":\"700_5490\"}},\"isHistoricalReplay\":false}";

    @Test
    public void megaNestedComment() throws IOException {
        EventDocument doc = parseTestDoc(megaNestedComment);
        writeAvroDoc(cloneEventDocument(doc), new File(TMP_OUT));
    }

    EventDocument parseTestDoc(String doc) throws IOException {
        return mapper.readValue(doc, EventDocument.class);
    }


    AvroEvent cloneEventDocument(EventDocument doc){
        return JsonAvroCloner.clone(doc);
    }

    public void writeAvroDoc(SpecificRecord avroDoc, File file) throws IOException {

        DatumWriter writer = new SpecificDatumWriter<>();
        DataFileWriter out = new DataFileWriter<>(writer);
        out.create(avroDoc.getSchema(), file);
        out.append(avroDoc);
        out.close();

    }
}
